title:	Implement Backend Authentication Routes
state:	OPEN
author:	baldawsari
labels:	bug, enhancement, high-priority
comments:	0
assignees:	
projects:	
milestone:	
number:	24
--
## ðŸš¨ CRITICAL BLOCKER

This issue blocks all frontend functionality and must be completed before any frontend testing work.

## Problem

The `backend/src/routes/auth.js` file is **completely empty**, causing all authentication-related functionality to fail. The frontend expects these endpoints but receives 404 errors.

## Root Cause

No authentication routes have been implemented in the backend, despite the frontend being fully built to use them.

## Implementation Requirements

### 1. POST /api/auth/login
- Accept: `{ email: string, password: string }`
- Validate credentials with Supabase Auth
- Return: `{ user: UserObject, token: string, refreshToken: string }`
- Set appropriate HTTP-only cookies for tokens

### 2. POST /api/auth/register  
- Accept: `{ name: string, email: string, password: string, role: string, organization?: string, useCase?: string }`
- Create user in Supabase Auth
- Create user profile in database
- Return: `{ user: UserObject, token: string, refreshToken: string }`

### 3. POST /api/auth/refresh
- Accept: `{ refreshToken: string }`
- Validate and refresh tokens with Supabase
- Return: `{ token: string, refreshToken: string }`

### 4. POST /api/auth/logout
- Clear authentication cookies
- Revoke tokens if needed
- Return: `{ success: true }`

### 5. GET /api/auth/me
- Require valid JWT token
- Return current user profile
- Include role and permissions

## Technical Requirements

- Use existing `supabaseAdmin` from `src/config/database.js`
- Integrate with existing auth middleware in `src/middleware/auth.ts`
- Follow error handling patterns from other routes
- Add proper validation using Joi
- Include rate limiting for auth endpoints

## Testing

After implementation:
1. All auth frontend tests should pass
2. Manual testing of login/register flow
3. Token refresh mechanism works
4. Protected routes are accessible only with valid tokens

## Success Criteria

- [ ] All 5 endpoints implemented and working
- [ ] Frontend can successfully login/register users
- [ ] Token refresh works automatically
- [ ] Protected routes return 401 without valid token
- [ ] All auth-related frontend tests pass

## References

- Frontend auth implementation: `frontend/src/app/(auth)/`
- Auth middleware: `backend/src/middleware/auth.ts`
- API client expectations: `frontend/src/lib/api/client.ts`
